import { MBTIResult } from "./types";

const emotionToMBTIMapping: Record<string, MBTIResult[]> = {
  // face-api.jsÏùò 7Í∞ÄÏßÄ Í∞êÏ†ï
  neutral: [
    {
      type: "ISTJ",
      description:
        "Ïã§Ïö©Ï†ÅÏù¥Í≥† ÏÇ¨Ïã§Ïóê Í∑ºÍ±∞Ìïú Í≤ÄÏÇ¨Í¥Ä! ÎãπÏã†ÏùÄ Ï±ÖÏûÑÍ∞êÏù¥ Í∞ïÌïòÎ©∞ ÏßàÏÑúÏôÄ Í∑úÏπôÏùÑ Ï§ëÏöîÏãúÌï©ÎãàÎã§.",
      confidence: 0.6,
    },
    {
      type: "ISFJ",
      description:
        "Ï†ÑÎÖêÌïòÍ≥† Îî∞ÎúªÌïú ÏàòÌò∏Ïûê! ÎãπÏã†ÏùÄ ÏïàÏ†ïÍ∞êÏùÑ Ï§ëÏöîÏãúÌïòÎ©∞ Îã§Î•∏ ÏÇ¨ÎûåÎì§ÏùÑ ÎèåÎ≥¥Îäî Í≤ÉÏùÑ Ï¢ãÏïÑÌï©ÎãàÎã§.",
      confidence: 0.5,
    },
  ],
  happy: [
    {
      type: "ENFP",
      description:
        "Ïó¥Ï†ïÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ ÏûêÏú†Î°úÏö¥ ÏòÅÌòº! ÎãπÏã†ÏùÄ ÏÉàÎ°úÏö¥ ÏïÑÏù¥ÎîîÏñ¥Î•º ÏÇ¨ÎûëÌïòÍ≥† ÏÇ¨ÎûåÎì§Í≥ºÏùò Ïó∞Í≤∞ÏùÑ Ï§ëÏöîÏãúÌï©ÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ESFP",
      description:
        "Ï¶êÍ±∞ÏõÄÏùÑ ÎÇòÎàÑÎäî ÏÇ¨ÍµêÏ†ÅÏù∏ ÏóîÌÑ∞ÌÖåÏù¥ÎÑà! ÎãπÏã†ÏùÄ ÌòÑÏû¨Î•º Ï¶êÍ∏∞Î©∞ Îã§Î•∏ ÏÇ¨ÎûåÎì§ÏùÑ ÏõÉÍ≤å ÎßåÎìúÎäî Ïû¨Îä•Ïù¥ ÏûàÏäµÎãàÎã§.",
      confidence: 0.7,
    },
  ],
  sad: [
    {
      type: "INFP",
      description:
        "ÍπäÏùÄ Í∞êÏÑ±ÏùÑ Í∞ÄÏßÑ Ïù¥ÏÉÅÏ£ºÏùòÏûê! ÎãπÏã†ÏùÄ ÎÇ¥Î©¥Ïùò Í∞ÄÏπòÍ¥ÄÏùÑ Ï§ëÏöîÏãúÌïòÎ©∞ Ï∞ΩÏùòÏ†ÅÏù∏ ÌëúÌòÑÏùÑ ÌÜµÌï¥ ÏûêÏã†ÏùÑ ÎìúÎü¨ÎÉÖÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ISFP",
      description:
        "Ï°∞Ïö©ÌïòÏßÄÎßå Îî∞ÎúªÌïú ÏòàÏà†Í∞Ä! ÎãπÏã†ÏùÄ ÏïÑÎ¶ÑÎã§ÏõÄÏùÑ Ï∂îÍµ¨ÌïòÎ©∞ ÏûêÏã†ÎßåÏùò Î∞©ÏãùÏúºÎ°ú ÏÑ∏ÏÉÅÏùÑ Î∞îÎùºÎ¥ÖÎãàÎã§.",
      confidence: 0.7,
    },
  ],
  angry: [
    {
      type: "ENTJ",
      description:
        "ÎåÄÎã¥ÌïòÍ≥† ÏÉÅÏÉÅÎ†•Ïù¥ ÌíçÎ∂ÄÌïú ÏßÄÎèÑÏûê! ÎãπÏã†ÏùÄ Í∞ïÌïú ÏùòÏßÄÏôÄ Í≤∞Îã®Î†•ÏùÑ Í∞ÄÏßÄÍ≥† Î™©ÌëúÎ•º Îã¨ÏÑ±Ìï©ÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ESTJ",
      description:
        "Ïã§Ïö©Ï†ÅÏù¥Í≥† ÏÇ¨Ïã§Ïóê Í∑ºÍ±∞Ìïú Í¥ÄÎ¶¨Ïûê! ÎãπÏã†ÏùÄ ÏßàÏÑúÏôÄ Í∑úÏπôÏùÑ Ï§ëÏöîÏãúÌïòÎ©∞ Ìö®Ïú®Ï†ÅÏúºÎ°ú ÏùºÏùÑ Ï≤òÎ¶¨Ìï©ÎãàÎã§.",
      confidence: 0.7,
    },
  ],
  fearful: [
    {
      type: "INFJ",
      description:
        "Ï°∞Ïö©ÌïòÍ≥† Ïã†ÎπÑÎ°úÏö¥ Ïù¥ÏÉÅÏ£ºÏùòÏûê! ÎãπÏã†ÏùÄ ÍπäÏùÄ ÌÜµÏ∞∞Î†•ÏùÑ Í∞ÄÏßÄÍ≥† ÏûàÏúºÎ©∞ Îã§Î•∏ ÏÇ¨ÎûåÎì§ÏùÑ ÎèïÎäî Í≤ÉÏùÑ Ï¢ãÏïÑÌï©ÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ISFJ",
      description:
        "Ï†ÑÎÖêÌïòÍ≥† Îî∞ÎúªÌïú ÏàòÌò∏Ïûê! ÎãπÏã†ÏùÄ ÏïàÏ†ïÍ∞êÏùÑ Ï§ëÏöîÏãúÌïòÎ©∞ Îã§Î•∏ ÏÇ¨ÎûåÎì§ÏùÑ ÎèåÎ≥¥Îäî Í≤ÉÏùÑ Ï¢ãÏïÑÌï©ÎãàÎã§.",
      confidence: 0.7,
    },
  ],
  disgusted: [
    {
      type: "INTJ",
      description:
        "ÏÉÅÏÉÅÎ†•Ïù¥ ÌíçÎ∂ÄÌïòÍ≥† Ï†ÑÎûµÏ†ÅÏù∏ ÏÇ¨ÏÉÅÍ∞Ä! ÎãπÏã†ÏùÄ Î™®Îì† ÏùºÏóê Í≥ÑÌöçÏùÑ ÏÑ∏Ïö∞Î©∞ ÏßÄÏ†Å ÎèÑÏ†ÑÏùÑ Ï∂îÍµ¨Ìï©ÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ISTJ",
      description:
        "Ïã§Ïö©Ï†ÅÏù¥Í≥† ÏÇ¨Ïã§Ïóê Í∑ºÍ±∞Ìïú Í≤ÄÏÇ¨Í¥Ä! ÎãπÏã†ÏùÄ Ï±ÖÏûÑÍ∞êÏù¥ Í∞ïÌïòÎ©∞ ÏßàÏÑúÏôÄ Í∑úÏπôÏùÑ Ï§ëÏöîÏãúÌï©ÎãàÎã§.",
      confidence: 0.7,
    },
  ],
  surprised: [
    {
      type: "ENFP",
      description:
        "Ïó¥Ï†ïÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ ÏûêÏú†Î°úÏö¥ ÏòÅÌòº! ÎãπÏã†ÏùÄ ÏÉàÎ°úÏö¥ Í≤ΩÌóòÏùÑ Ï∂îÍµ¨ÌïòÎ©∞ Ìò∏Í∏∞Ïã¨Ïù¥ ÎßéÏäµÎãàÎã§.",
      confidence: 0.8,
    },
    {
      type: "ENTP",
      description:
        "ÎåÄÎã¥ÌïòÍ≥† ÎèÖÏ∞ΩÏ†ÅÏù∏ ÏÇ¨ÏÉÅÍ∞Ä! ÎãπÏã†ÏùÄ ÏßÄÏ†Å ÎèÑÏ†ÑÏùÑ Ï¶êÍ∏∞Î©∞ ÏÉàÎ°úÏö¥ ÏïÑÏù¥ÎîîÏñ¥Î•º ÌÉêÍµ¨Ìï©ÎãàÎã§.",
      confidence: 0.7,
    },
  ],
};

// MBTI ÌÉÄÏûÖÎ≥Ñ Ïù¥Î™®ÏßÄ Îß§Ìïë
export const getMBTIEmoji = (type: string) => {
  const emojiMap: Record<string, string> = {
    ENFP: "üåü",
    ENFJ: "üí´",
    ENTP: "üí°",
    ENTJ: "üëë",
    ESFP: "üéâ",
    ESFJ: "ü§ó",
    ESTP: "üèÉ‚Äç‚ôÇÔ∏è",
    ESTJ: "üìã",
    INFP: "üå∏",
    INFJ: "üåô",
    INTP: "üß†",
    INTJ: "üîÆ",
    ISFP: "üé®",
    ISFJ: "üõ°Ô∏è",
    ISTP: "üîß",
    ISTJ: "‚öñÔ∏è",
  };
  return emojiMap[type] || "ü§î";
};

// MBTI ÌÉÄÏûÖÎ≥Ñ ÏÑ§Î™Ö
export const getMBTIDescription = (type: string): string => {
  const descriptions: Record<string, string> = {
    ISTJ: "Ïã†Ï§ëÌïòÍ≥† Ï±ÖÏûÑÍ∞ê ÏûàÎäî ÌòÑÏã§Ï£ºÏùòÏûê",
    ISFJ: "Îî∞ÎúªÌïòÍ≥† ÌóåÏã†Ï†ÅÏù∏ Î≥¥Ìò∏Ïûê",
    INFJ: "Ïù¥ÏÉÅÏ£ºÏùòÏ†ÅÏù¥Í≥† ÌÜµÏ∞∞Î†• ÏûàÎäî Ï°∞Ïñ∏Ïûê",
    ENFP: "Ïó¥Ï†ïÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ ÌôúÎèôÍ∞Ä",
    ENTP: "ÎÖºÎ¶¨Ï†ÅÏù¥Í≥† ÌòÅÏã†Ï†ÅÏù∏ ÏÇ¨ÏÉÅÍ∞Ä",
    ESFP: "Ï¶âÌù•Ï†ÅÏù¥Í≥† ÏπúÍ∑ºÌïú Ïó∞ÏòàÏù∏",
    INTP: "ÎÖºÎ¶¨Ï†ÅÏù¥Í≥† Î∂ÑÏÑùÏ†ÅÏù∏ ÌïôÏûê",
    INTJ: "Ï†ÑÎûµÏ†ÅÏù¥Í≥† ÎèÖÏ∞ΩÏ†ÅÏù∏ ÏÑ§Í≥ÑÏûê",
    ISTP: "Ïã§Ïö©Ï†ÅÏù¥Í≥† Ïú†Ïó∞Ìïú ÎßåÎä•Ïû¨Ï£ºÍæº",
    ENFJ: "Ïπ¥Î¶¨Ïä§Îßà ÏûàÍ≥† Ïù¥ÌÉÄÏ†ÅÏù∏ ÏßÄÎèÑÏûê",
    ENTJ: "ÎåÄÎã¥ÌïòÍ≥† ÏÉÅÏÉÅÎ†• ÌíçÎ∂ÄÌïú ÌÜµÏÜîÏûê",
    ESFJ: "ÏÇ¨ÍµêÏ†ÅÏù¥Í≥† ÎèôÏ†ïÏã¨ ÎßéÏùÄ Ïô∏ÍµêÍ¥Ä",
    INFP: "Ïù¥ÏÉÅÏ£ºÏùòÏ†ÅÏù¥Í≥† Ï∞ΩÏùòÏ†ÅÏù∏ Ï§ëÏû¨Ïûê",
    ISFP: "ÏòàÏà†Ï†ÅÏù¥Í≥† Î™®ÌóòÏ†ÅÏù∏ Î™®ÌóòÍ∞Ä",
    ESTJ: "ÏóÑÍ≤©ÌïòÍ≥† Ï≤¥Í≥ÑÏ†ÅÏù∏ Í≤ΩÏòÅÏûê",
  };
  return descriptions[type] || "Ïã†Ï§ëÌïòÍ≥† ÌòÑÏã§Ï†ÅÏù∏ ÏÑ±Í≤©";
};

// Í∞êÏ†ïÏùÑ MBTIÎ°ú Îß§Ìïë
export const mapEmotionToMBTI = (
  emotion: string,
  confidence: number
): MBTIResult => {
  const possibleResults =
    emotionToMBTIMapping[emotion] || emotionToMBTIMapping.neutral;

  // Ïã†Î¢∞ÎèÑÏóê Îî∞Îùº Í≤∞Í≥º ÏÑ†ÌÉù
  const selectedResult =
    confidence > 0.7
      ? possibleResults[0]
      : possibleResults[1] || possibleResults[0];

  // Ïã†Î¢∞ÎèÑ Ï°∞Ï†ï
  const adjustedConfidence = Math.min(
    selectedResult.confidence * confidence,
    1.0
  );

  return {
    ...selectedResult,
    confidence: adjustedConfidence,
  };
};
